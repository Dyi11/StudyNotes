##  傅里叶变换
# 短时傅里叶变换（STFT） 将音频信号从时域转换到频域，并可视化出频谱图

**STFT（短时傅里叶变换）**：是分析音频频率随时间变化的核心工具。它的原理是：将长音频切成很多短片段（“窗口”），对每个片段做傅里叶变换，得到每个时刻的频率分布，最后拼接成 “时间 - 频率” 的动态频谱

傅里叶变换（FT）的本质是将 “时域信号”（随时间变化的振幅）转换为 “频域信号”（不同频率的成分占比），但它有一个局限：只能适用于 “平稳信号”（频率成分不随时间变化的信号，比如纯正弦波）。
而音频信号是非平稳信号（频率随时间变化，比如说话时的声调起伏、乐器的滑音），如果直接对整段音频做傅里叶变换，得到的是 “整个时间段内所有频率的平均”，丢失了 “频率随时间变化” 的信息。
因此，STFT 引入了 “滑动窗口”：将长音频切成无数个短片段（每个片段称为一个 “窗口”），对每个窗口单独做傅里叶变换，再将结果按时间顺序拼接，就能得到 “频率随时间变化” 的动态频谱

**帮助理解**

傅里叶变换可以简单理解为一种“信号分解工具”，*核心思想是：任何复杂的信号（比如声音、图像），都可以拆成无数个不同频率的简单正弦波（或余弦波）的叠加*。

举个例子：  
比如一段音乐，听起来是各种乐器混合的声音，但傅里叶变换能“拆解”出其中包含哪些频率的声波（比如钢琴的高频、贝斯的低频），以及每个频率的强度（音量大小）

它的作用就像：把一杯混合果汁（复杂信号），分解成“多少橙汁、多少苹果汁、多少柠檬汁”（不同频率的正弦波），让我们看清复杂信号的“组成成分”。

在音频里，傅里叶变换能帮我们从“随时间变化的振幅”（时域），转换到“随频率变化的强度”（频域），直观看到声音里有哪些频率成分——这也是频谱图的底层原理。

傅里叶变换（FT）的这个局限，核心原因是它的**分析结果是“全局平均”的**——它会把整段信号的所有频率成分混在一起计算，无法体现频率随时间的变化，因此只适合频率成分固定的“平稳信号”。具体可以从这两点理解：

## 1. 先明确：什么是“平稳信号”？
平稳信号的核心特征是：**频率成分不随时间改变**。比如一个纯正弦波（比如固定音调的蜂鸣音），从开始到结束，它的振动频率始终不变，振幅也保持稳定，这就是典型的平稳信号。

对这类信号做傅里叶变换，结果非常清晰：频域图上只会在对应频率的位置出现一个尖锐的峰值，能准确反映它的频率和强度，没有任何歧义。

## 2. 非平稳信号的问题：频率随时间变，FT“算不准”

但现实中绝大多数信号（比如声音、语音、音乐）都是**非平稳信号**——它们的频率成分会随时间变化。比如：
- 一段语音：从“a”音换到“o”音，声调（频率）会变；
- 一段音乐：从贝斯（低频）切换到小提琴（高频），频率成分会剧烈变化；
- 狗叫声：从低沉的起始到尖锐的高潮，频率也在动态变化。

此时对整段非平稳信号做傅里叶变换，会出现两个关键问题：
#### （1）丢失“时间信息”
FT的结果只告诉我们“这段信号里包含哪些频率”，但不知道“这些频率分别在哪个时间出现”。比如对一段“先有贝斯声、后有小提琴声”的音乐做FT，得到的频域图会同时显示贝斯的低频和小提琴的高频，但无法区分“低频在前、高频在后”，只能看作是“整个时间段内低频和高频都存在”。

#### （2）频率模糊（频谱泄漏）
由于FT假设信号是“无限长且频率固定”的，当处理有限长度的非平稳信号时，会把信号的“边缘突变”（比如从贝斯切到小提琴的瞬间）误判为额外的频率成分，导致频域图上的峰值变宽、出现杂波，无法准确反映真实的频率分布。

### 举个直观的例子
假设我们有两段信号：
- 信号A（平稳）：100 Hz的纯正弦波持续2秒；
- 信号B（非平稳）：前1秒是100 Hz正弦波，后1秒是1000 Hz正弦波。

对信号A做FT，频域图上只会在100 Hz处有一个清晰峰值，完全准确；
对信号B做FT，频域图上会在100 Hz和1000 Hz处都出现峰值，但无法知道这两个频率分别对应前1秒和后1秒——从FT结果看，会误以为“2秒内100 Hz和1000 Hz同时存在”，完全扭曲了信号的时间动态特征。

### 总结
傅里叶变换的本质是对“整个信号周期”做全局频率分析，它的数学假设就是“信号的频率特性不随时间变化”。当这个假设不成立（非平稳信号）时，它就无法区分频率的时间分布，导致结果失真或信息丢失。这也是为什么我们需要“短时傅里叶变换（STFT）”——通过滑动窗口把非平稳信号拆成多个局部平稳的短片段，再逐个做FT，从而保留“频率随时间变化”的信息。
